; generated by ARM C/C++ Compiler, 4.1 [Build 894]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o..\Output\tim6.o --asm_dir=..\Listing\ --list_dir=..\Listing\ --depend=..\Output\tim6.d --cpu=Cortex-M4.fp --apcs=interwork -O1 --diag_suppress=870 -I..\APP -I..\drive -I..\Include -I..\Libraries\CMSIS\inc -I..\Libraries\CMSIS\src -I..\Libraries\FWlib\inc -I..\Libraries\FWlib\src -I..\Listing -I..\Output -I..\Project -I..\STemWinLibrary522\Config -I..\STemWinLibrary522\emWinTask -I..\STemWinLibrary522\GUILib -I..\STemWinLibrary522\inc -I..\User -I..\USB\STM32_USB_HOST_Library\Class\HID\inc -I..\USB\STM32_USB_HOST_Library\Class\MSC\src -I..\USB\STM32_USB_HOST_Library\Core\src -I..\USB\USB_APP -I..\USB\STM32_USB_HOST_Library\Class\HID\src -I..\USB\STM32_USB_HOST_Library\Class\MSC\inc -I..\USB\STM32_USB_HOST_Library\Core\inc -I..\USB\STM32_USB_OTG_Driver\inc -I..\FATFS\exfuns -I..\FATFS\src\option -I..\FATFS\src -I..\MALLOC -ID:\Keil\ARM\RV31\Inc -ID:\Keil\ARM\CMSIS\Include -ID:\Keil\ARM\Inc\ST\STM32F4xx -DUSE_STDPERIPH_DRIVER -DSTM32F40XX -DUSE_USB_OTG_FS -DUSE_EMBEDDED_PHY -DUSE_USB_OTG_HS -DSTM32F40XX --omf_browse=..\Output\tim6.crf ..\drive\TIM6.c]
                          THUMB

                          AREA ||i.MODS_Poll||, CODE, READONLY, ALIGN=2

                  MODS_Poll PROC
;;;572    
;;;573    void MODS_Poll(void)
000000  b510              PUSH     {r4,lr}
;;;574    {
;;;575    	uint16_t addr;
;;;576    	static uint16_t crc1;
;;;577        static u32 testi;
;;;578    	/* è¶…è¿‡3.5ä¸ªå­—ç¬¦æ—¶é—´åŽæ‰§è¡ŒMODH_RxTimeOut()å‡½æ•°ã€‚å…¨å±€å˜é‡ g_rtu_timeout = 1; é€šçŸ¥ä¸»ç¨‹åºå¼€å§‹è§£ç ?*/
;;;579    //	if (g_mods_timeout == 0)	
;;;580    //	{
;;;581    //		return;								/* æ²¡æœ‰è¶…æ—¶ï¼Œç»§ç»­æŽ¥æ”¶ã€‚ä¸è¦æ¸…é›?g_tModS.RxCount */
;;;582    //	}
;;;583    
;;;584        testi=g_tModS.RxCount;
000002  4c13              LDR      r4,|L1.80|
000004  4a13              LDR      r2,|L1.84|
000006  f894009e          LDRB     r0,[r4,#0x9e]  ; g_tModS
00000a  6250              STR      r0,[r2,#0x24]  ; testi
;;;585        testi=g_tModS.RxCount;
;;;586        testi=g_tModS.RxCount;
;;;587    	if(testi>7)				/* ½ÓÊÕµ½µÄÊý¾ÝÐ¡ÓÚ4¸ö×Ö½Ú¾ÍÈÏÎª´íÎó */
;;;588    	{
;;;589    		testi=testi;
;;;590    	}
;;;591    	testi=g_tModS.RxCount;
;;;592        if(testi==8)				/* ½ÓÊÕµ½µÄÊý¾ÝÐ¡ÓÚ4¸ö×Ö½Ú¾ÍÈÏÎª´íÎó */
00000c  2808              CMP      r0,#8
00000e  d101              BNE      |L1.20|
;;;593    	{
;;;594    		testi=testi+1;
000010  2109              MOVS     r1,#9
000012  6251              STR      r1,[r2,#0x24]  ; testi
                  |L1.20|
;;;595    	}
;;;596    	//ÅÐ¶ÏÍ¨Ñ¶½ÓÊÕÊÇ·ñ³¬Ê±
;;;597    	if(OldTick!=Tick_10ms)
000014  6b53              LDR      r3,[r2,#0x34]  ; OldTick
000016  6911              LDR      r1,[r2,#0x10]  ; Tick_10ms
000018  428b              CMP      r3,r1
00001a  d014              BEQ      |L1.70|
;;;598      	{  
;;;599    	  OldTick=Tick_10ms;
00001c  6351              STR      r1,[r2,#0x34]  ; OldTick
;;;600    	   if(g_mods_timeout>0)
00001e  4a0e              LDR      r2,|L1.88|
000020  7811              LDRB     r1,[r2,#0]  ; g_mods_timeout
000022  b109              CBZ      r1,|L1.40|
;;;601          { 
;;;602    	    g_mods_timeout--;
000024  1e49              SUBS     r1,r1,#1
000026  7011              STRB     r1,[r2,#0]
                  |L1.40|
;;;603          }
;;;604    	  if(g_mods_timeout==0 && g_tModS.RxCount>0)   //ÓÐÊýµ«³¬Ê±ÁË
000028  7811              LDRB     r1,[r2,#0]  ; g_mods_timeout
00002a  2900              CMP      r1,#0
00002c  d10b              BNE      |L1.70|
00002e  2800              CMP      r0,#0
000030  d009              BEQ      |L1.70|
;;;605          { 
;;;606    		// goto err_ret;
;;;607    	
;;;608          }
;;;609          else if(g_mods_timeout==0 && g_tModS.RxCount==0) //Ã»Êý³¬Ê±ÁË
;;;610             return;
;;;611          else //Ã»³¬Ê±ÁË£¬¼ÌÐøÊÕ
;;;612             return;
;;;613    	}
;;;614    	else   //Ã»ÓÐµ½10ms£¬²»½øÈë½âÎö
;;;615    		return;
;;;616    	//g_mods_timeout = 0;	 					/* Çå±êÖ¾ */
;;;617    
;;;618    	if (g_tModS.RxCount < 4)				/* ½ÓÊÕµ½µÄÊý¾ÝÐ¡ÓÚ4¸ö×Ö½Ú¾ÍÈÏÎª´íÎó */
000032  2804              CMP      r0,#4
000034  d304              BCC      |L1.64|
;;;619    	{
;;;620    		goto err_ret;
;;;621    	}
;;;622    
;;;623    	/* ¼ÆËãCRCÐ£ÑéºÍ */
;;;624    // 	crc1 = CRC16(g_tModS.RxBuf, g_tModS.RxCount);
;;;625    // 	if (crc1 != 0)
;;;626    // 	{
;;;627    // 		goto err_ret;
;;;628    // 	}
;;;629    
;;;630    // 	/* Õ¾µØÖ· (1×Ö½Ú£© */
;;;631    // 	addr = g_tModS.RxBuf[0];				/* µÚ1×Ö½Ú Õ¾ºÅ */
;;;632    // 	if (addr != SADDR485)		 			/* ÅÐ¶ÏÖ÷»ú·¢ËÍµÄÃüÁîµØÖ·ÊÇ·ñ·ûºÏ */
;;;633    // 	{
;;;634    // 		goto err_ret;
;;;635    // 	}
;;;636    
;;;637    	/* åˆ†æžåº”ç”¨å±‚åè®?*/
;;;638        if(g_tModS.RxBuf[2] == 0xA5)
000036  78a0              LDRB     r0,[r4,#2]  ; g_tModS
000038  28a5              CMP      r0,#0xa5
00003a  d005              BEQ      |L1.72|
;;;639        {
;;;640            UART_Action();
;;;641        }else{
;;;642    //        usartocflag = 1;
;;;643            RecHandle();
00003c  f7fffffe          BL       RecHandle
                  |L1.64|
;;;644        }
;;;645    							
;;;646    	
;;;647    err_ret:
;;;648    #if 0										/* æ­¤éƒ¨åˆ†ä¸ºäº†ä¸²å£æ‰“å°ç»“æž?å®žé™…è¿ç”¨ä¸­å¯ä¸è¦ */
;;;649    	g_tPrint.Rxlen = g_tModS.RxCount;
;;;650    	memcpy(g_tPrint.RxBuf, g_tModS.RxBuf, g_tModS.RxCount);
;;;651    #endif
;;;652    	
;;;653     	g_tModS.RxCount = 0;					/* å¿…é¡»æ¸…é›¶è®¡æ•°å™¨ï¼Œæ–¹ä¾¿ä¸‹æ¬¡å¸§åŒæ­?*/
000040  2000              MOVS     r0,#0
000042  f884009e          STRB     r0,[r4,#0x9e]
                  |L1.70|
;;;654    }
000046  bd10              POP      {r4,pc}
                  |L1.72|
000048  f7fffffe          BL       UART_Action
00004c  e7f8              B        |L1.64|
;;;655    
                          ENDP

00004e  0000              DCW      0x0000
                  |L1.80|
                          DCD      g_tModS
                  |L1.84|
                          DCD      ||.data||
                  |L1.88|
                          DCD      g_mods_timeout

                          AREA ||i.TIM3_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM3_IRQHandler PROC
;;;389    //??? 3 ??????
;;;390    void TIM3_IRQHandler(void)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;391    {
000004  ed2d8b02          VPUSH    {d8}
;;;392        static vu8 calert = 0;
;;;393        static vu16 resetcount;
;;;394        static vu8 read1963;
;;;395        static vu16 scancount;
;;;396        static vu32 ctime,dctime;
;;;397        
;;;398        if(TIM_GetITStatus(TIM3,TIM_IT_Update)==SET) //????
000008  2101              MOVS     r1,#1
00000a  4c92              LDR      r4,|L2.596|
00000c  4620              MOV      r0,r4
00000e  f7fffffe          BL       TIM_GetITStatus
000012  2801              CMP      r0,#1
000014  d123              BNE      |L2.94|
;;;399        {
;;;400            TIM_ClearITPendingBit(TIM3,TIM_IT_Update); //??????¦Ë
000016  2101              MOVS     r1,#1
000018  4620              MOV      r0,r4
00001a  f7fffffe          BL       TIM_ClearITPendingBit
;;;401    //         if(page_sw != face_starter)
;;;402    //         {
;;;403    //              if(resetflag == 1)
;;;404    //              {
;;;405    //                  if(resetcount == 1)
;;;406    //                  {
;;;407    //                      LCD_Initializtion();
;;;408    //                      sLCD_WR_REG(0xf1);
;;;409    //                      GUI_Init();
;;;410    //                      if(page_sw == face_menu)
;;;411    //                      {
;;;412    //                          ResetPow();
;;;413    //                      }else if(page_sw == face_cdc){
;;;414    //                          ResetCDC();
;;;415    //                      }else if(page_sw == face_r){
;;;416    //                          ResetR();
;;;417    //                      }else if(page_sw == face_load){
;;;418    //                          ResetLoad();
;;;419    //                      }else if(page_sw == face_graph){
;;;420    //                          ResetG();
;;;421    //                      }else if(page_sw == face_set){
;;;422    //                          ResetSET();
;;;423    //                      }
;;;424    //                      resdone = 1;
;;;425    // //                     resetflag = 0;
;;;426    //                      resetcount = 0;
;;;427    //                  }else{
;;;428    //                      resetcount++;
;;;429    //                  }                
;;;430    //              }
;;;431    //          }
;;;432            switch(page_sw)
00001e  488e              LDR      r0,|L2.600|
000020  f890c000          LDRB     r12,[r0,#0]  ; page_sw
;;;433            {
;;;434                case face_menu:
;;;435                {
;;;436                    if(pow_sw == pow_on)
000024  4a8d              LDR      r2,|L2.604|
;;;437                    {
;;;438                        bc_raw += DISS_POW_Current * 1000 * 1/3600;
000026  4b8e              LDR      r3,|L2.608|
;;;439                    }else{
;;;440                        bc_raw = 0;
;;;441                    }
;;;442                }break;
;;;443                case face_cdc:
;;;444                {
;;;445                    if(mode_sw == mode_pow && cdc_sw == cdc_on)
;;;446                    {
;;;447                        ctime++;
;;;448                        second = ctime%60;//ç§’
;;;449                        minute = (ctime/60)%60;//åˆ†
;;;450                        hour   = ctime/3600;//æ—¶
;;;451                        cbc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;452                        bc_raw = 0;
;;;453    //                    bc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;454                    }else if(mode_sw == mode_load && cdc_sw == cdc_on){
;;;455                        dctime++;
;;;456                        second1 = dctime%60;//ç§’
;;;457                        minute1 = (dctime/60)%60;//åˆ†
;;;458                        hour1   = dctime/3600;//æ—¶
;;;459                        bc_raw += DISS_Current * 1000 * 1/3600;
000028  4d8e              LDR      r5,|L2.612|
;;;460    //                    c_sum += DISS_Current * 1000 * 1/3600;
;;;461                        cbc_raw = 0;
;;;462                    }else if(cdc_sw == cdc_off){
;;;463                        bc_raw = 0;
;;;464                        cbc_raw = 0;
;;;465                        c_sum = 0;
;;;466                        ctime=0;
00002a  2600              MOVS     r6,#0
;;;467                        dctime=0;
;;;468                    }
;;;469                }break;
;;;470                case face_load:
;;;471                {
;;;472                    if(load_sw == load_on)
;;;473                    {
;;;474                        if(alert_flag == 1)
00002c  488e              LDR      r0,|L2.616|
00002e  498f              LDR      r1,|L2.620|
000030  f8df823c          LDR      r8,|L2.624|
000034  4f8f              LDR      r7,|L2.628|
000036  ed9f8a90          VLDR     s16,|L2.632|
00003a  eddf8a90          VLDR     s17,|L2.636|
00003e  ed9f0a90          VLDR     s0,|L2.640|
000042  4c90              LDR      r4,|L2.644|
000044  f1bc0f05          CMP      r12,#5                ;432
000048  d209              BCS      |L2.94|
00004a  e8dff00c          TBB      [pc,r12]              ;432
00004e  af19              DCB      0xaf,0x19
000050  03f08700          DCB      0x03,0xf0,0x87,0x00
000054  7810              LDRB     r0,[r2,#0]            ;436  ; pow_sw
000056  2801              CMP      r0,#1                 ;436
000058  d005              BEQ      |L2.102|
00005a  ed840a0a          VSTR     s0,[r4,#0x28]         ;440
                  |L2.94|
;;;475                        {
;;;476                            calert ++;
;;;477                            if(calert == 3)
;;;478                            {
;;;479                                t_onoff = 0;
;;;480                                GPIO_SetBits(GPIOA,GPIO_Pin_15);//????OFF
;;;481                                mode_sw = 0;
;;;482                                load_sw = load_off;
;;;483                                calert = 0;                                
;;;484                            }
;;;485                        }
;;;486                        bc_raw += DISS_Current * 1000 * 1/3600;
;;;487                    }else{
;;;488                        bc_raw = 0;
;;;489                    }
;;;490                }break;
;;;491                case face_graph:
;;;492                {
;;;493                    if(mode_sw == mode_pow)
;;;494                    {
;;;495                        if(pow_sw == pow_on)
;;;496                        {
;;;497                            bc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;498                        }else if(mode_sw == mode_pow && cdc_sw == cdc_on)
;;;499                        {
;;;500                            bc_raw += DISS_POW_Current * 1000 * 1/3600;
;;;501                        }
;;;502                        else{
;;;503                            bc_raw = 0;
;;;504                        }
;;;505                    }               
;;;506                    
;;;507                    if(mode_sw == mode_load)
;;;508                    {
;;;509                        if(load_sw == load_on)
;;;510                        {
;;;511                            bc_raw += DISS_Current * 1000 * 1/3600;
;;;512                        }else{
;;;513                            bc_raw = 0;
;;;514                        }
;;;515                    }
;;;516                }break;
;;;517                case face_r:
;;;518                {
;;;519                    if(oct_sw == oct_on)
;;;520                    {
;;;521                        if(alert_flag == 1)
;;;522                        {
;;;523                            calert ++;
;;;524                            if(calert == 3)
;;;525                            {
;;;526                                ocstop = 1;
;;;527                                calert = 0;
;;;528                            }
;;;529                        }
;;;530                    }
;;;531                }break;
;;;532            }
;;;533    //         GPIO_ResetBits(GPIOD,GPIO_Pin_12);
;;;534    //         TM1650_SET_LED(0x48,0x71);
;;;535    //         TM1650_SET_LED(0x68,0xF2);//PASS?
;;;536        }    
;;;537        
;;;538    }
00005e  ecbd8b02          VPOP     {d8}
000062  e8bd87f0          POP      {r4-r10,pc}
                  |L2.102|
000066  ed930a00          VLDR     s0,[r3,#0]            ;438
00006a  ee200a08          VMUL.F32 s0,s0,s16             ;438
00006e  eec00a28          VDIV.F32 s1,s0,s17             ;438
000072  ed940a0a          VLDR     s0,[r4,#0x28]         ;438
000076  ee300a80          VADD.F32 s0,s1,s0              ;438
00007a  ed840a0a          VSTR     s0,[r4,#0x28]         ;438
00007e  e7ee              B        |L2.94|
000080  f897c000          LDRB     r12,[r7,#0]           ;445  ; mode_sw
000084  203c              MOVS     r0,#0x3c              ;448
000086  f44f6261          MOV      r2,#0xe10             ;450
00008a  f1bc0f03          CMP      r12,#3                ;445
00008e  d104              BNE      |L2.154|
000090  f891c000          LDRB     r12,[r1,#0]           ;445  ; cdc_sw
000094  f1bc0f01          CMP      r12,#1                ;445
000098  d003              BEQ      |L2.162|
                  |L2.154|
00009a  783b              LDRB     r3,[r7,#0]            ;454  ; mode_sw
00009c  2b02              CMP      r3,#2                 ;454
00009e  d027              BEQ      |L2.240|
0000a0  e029              B        |L2.246|
                  |L2.162|
0000a2  69e1              LDR      r1,[r4,#0x1c]         ;447  ; ctime
0000a4  1c49              ADDS     r1,r1,#1              ;447
0000a6  61e1              STR      r1,[r4,#0x1c]         ;447  ; ctime
0000a8  69e1              LDR      r1,[r4,#0x1c]         ;448  ; ctime
0000aa  fbb1f5f0          UDIV     r5,r1,r0              ;448
0000ae  fb001115          MLS      r1,r0,r5,r1           ;448
0000b2  4d75              LDR      r5,|L2.648|
0000b4  7029              STRB     r1,[r5,#0]            ;448
0000b6  69e1              LDR      r1,[r4,#0x1c]         ;449  ; ctime
0000b8  fbb1f1f0          UDIV     r1,r1,r0              ;449
0000bc  fbb1f5f0          UDIV     r5,r1,r0              ;449
0000c0  fb001015          MLS      r0,r0,r5,r1           ;449
0000c4  4971              LDR      r1,|L2.652|
0000c6  7008              STRB     r0,[r1,#0]            ;449
0000c8  69e0              LDR      r0,[r4,#0x1c]         ;450  ; ctime
0000ca  4971              LDR      r1,|L2.656|
0000cc  fbb0f0f2          UDIV     r0,r0,r2              ;450
0000d0  7008              STRB     r0,[r1,#0]            ;450
0000d2  edd30a00          VLDR     s1,[r3,#0]            ;451
0000d6  ee600a88          VMUL.F32 s1,s1,s16             ;451
0000da  ee801aa8          VDIV.F32 s2,s1,s17             ;451
0000de  edd40a0b          VLDR     s1,[r4,#0x2c]         ;451
0000e2  ee710a20          VADD.F32 s1,s2,s1              ;451
0000e6  edc40a0b          VSTR     s1,[r4,#0x2c]         ;451
0000ea  ed840a0a          VSTR     s0,[r4,#0x28]         ;452
0000ee  e7b6              B        |L2.94|
                  |L2.240|
0000f0  780b              LDRB     r3,[r1,#0]            ;454  ; cdc_sw
0000f2  2b01              CMP      r3,#1                 ;454
0000f4  d00b              BEQ      |L2.270|
                  |L2.246|
0000f6  7808              LDRB     r0,[r1,#0]            ;462  ; cdc_sw
0000f8  2800              CMP      r0,#0                 ;462
0000fa  d1b0              BNE      |L2.94|
0000fc  ed840a0a          VSTR     s0,[r4,#0x28]         ;463
000100  ed840a0b          VSTR     s0,[r4,#0x2c]         ;464
000104  ed840a0c          VSTR     s0,[r4,#0x30]         ;465
000108  61e6              STR      r6,[r4,#0x1c]         ;466  ; ctime
00010a  6226              STR      r6,[r4,#0x20]         ;467  ; dctime
                  |L2.268|
00010c  e7a7              B        |L2.94|
                  |L2.270|
00010e  6a21              LDR      r1,[r4,#0x20]         ;455  ; dctime
000110  1c49              ADDS     r1,r1,#1              ;455
000112  6221              STR      r1,[r4,#0x20]         ;455  ; dctime
000114  6a21              LDR      r1,[r4,#0x20]         ;456  ; dctime
000116  fbb1f3f0          UDIV     r3,r1,r0              ;456
00011a  fb001113          MLS      r1,r0,r3,r1           ;456
00011e  4b5d              LDR      r3,|L2.660|
000120  7019              STRB     r1,[r3,#0]            ;456
000122  6a21              LDR      r1,[r4,#0x20]         ;457  ; dctime
000124  fbb1f1f0          UDIV     r1,r1,r0              ;457
000128  fbb1f3f0          UDIV     r3,r1,r0              ;457
00012c  fb001013          MLS      r0,r0,r3,r1           ;457
000130  4959              LDR      r1,|L2.664|
000132  7008              STRB     r0,[r1,#0]            ;457
000134  6a20              LDR      r0,[r4,#0x20]         ;458  ; dctime
000136  4959              LDR      r1,|L2.668|
000138  fbb0f0f2          UDIV     r0,r0,r2              ;458
00013c  7008              STRB     r0,[r1,#0]            ;458
00013e  edd50a00          VLDR     s1,[r5,#0]            ;459
000142  ee600a88          VMUL.F32 s1,s1,s16             ;459
000146  ee801aa8          VDIV.F32 s2,s1,s17             ;459
00014a  edd40a0a          VLDR     s1,[r4,#0x28]         ;459
00014e  ee710a20          VADD.F32 s1,s2,s1              ;459
000152  edc40a0a          VSTR     s1,[r4,#0x28]         ;459
000156  ed840a0b          VSTR     s0,[r4,#0x2c]         ;461
                  |L2.346|
00015a  e780              B        |L2.94|
00015c  f8981000          LDRB     r1,[r8,#0]            ;472  ; load_sw
000160  2901              CMP      r1,#1                 ;472
000162  d002              BEQ      |L2.362|
000164  ed840a0a          VSTR     s0,[r4,#0x28]         ;488
000168  e779              B        |L2.94|
                  |L2.362|
00016a  7800              LDRB     r0,[r0,#0]            ;474  ; alert_flag
00016c  2801              CMP      r0,#1                 ;474
00016e  d110              BNE      |L2.402|
000170  78a0              LDRB     r0,[r4,#2]            ;476  ; calert
000172  1c40              ADDS     r0,r0,#1              ;476
000174  70a0              STRB     r0,[r4,#2]            ;476
000176  78a0              LDRB     r0,[r4,#2]            ;477  ; calert
000178  2803              CMP      r0,#3                 ;477
00017a  d10a              BNE      |L2.402|
00017c  4848              LDR      r0,|L2.672|
00017e  7006              STRB     r6,[r0,#0]            ;479
000180  f44f4100          MOV      r1,#0x8000            ;480
000184  4847              LDR      r0,|L2.676|
000186  f7fffffe          BL       GPIO_SetBits
00018a  703e              STRB     r6,[r7,#0]            ;481
00018c  f8886000          STRB     r6,[r8,#0]            ;482
000190  70a6              STRB     r6,[r4,#2]            ;483
                  |L2.402|
000192  ed950a00          VLDR     s0,[r5,#0]            ;486
000196  ee200a08          VMUL.F32 s0,s0,s16             ;486
00019a  eec00a28          VDIV.F32 s1,s0,s17             ;486
00019e  ed940a0a          VLDR     s0,[r4,#0x28]         ;486
0001a2  ee300a80          VADD.F32 s0,s1,s0              ;486
0001a6  ed840a0a          VSTR     s0,[r4,#0x28]         ;486
0001aa  e758              B        |L2.94|
0001ac  7838              LDRB     r0,[r7,#0]            ;493  ; mode_sw
0001ae  2803              CMP      r0,#3                 ;493
0001b0  d118              BNE      |L2.484|
0001b2  7810              LDRB     r0,[r2,#0]            ;495  ; pow_sw
0001b4  2801              CMP      r0,#1                 ;495
0001b6  d003              BEQ      |L2.448|
0001b8  7838              LDRB     r0,[r7,#0]            ;498  ; mode_sw
0001ba  2803              CMP      r0,#3                 ;498
0001bc  d00d              BEQ      |L2.474|
0001be  e00f              B        |L2.480|
                  |L2.448|
0001c0  edd30a00          VLDR     s1,[r3,#0]            ;497
0001c4  ee201a88          VMUL.F32 s2,s1,s16             ;497
0001c8  eec10a28          VDIV.F32 s1,s2,s17             ;497
0001cc  ed941a0a          VLDR     s2,[r4,#0x28]         ;497
0001d0  ee700a81          VADD.F32 s1,s1,s2              ;497
0001d4  edc40a0a          VSTR     s1,[r4,#0x28]         ;497
0001d8  e004              B        |L2.484|
                  |L2.474|
0001da  7808              LDRB     r0,[r1,#0]            ;498  ; cdc_sw
0001dc  2801              CMP      r0,#1                 ;498
0001de  d00b              BEQ      |L2.504|
                  |L2.480|
0001e0  ed840a0a          VSTR     s0,[r4,#0x28]         ;503
                  |L2.484|
0001e4  7838              LDRB     r0,[r7,#0]            ;507  ; mode_sw
0001e6  2802              CMP      r0,#2                 ;507
0001e8  d190              BNE      |L2.268|
0001ea  f8980000          LDRB     r0,[r8,#0]            ;509  ; load_sw
0001ee  2801              CMP      r0,#1                 ;509
0001f0  d00f              BEQ      |L2.530|
0001f2  ed840a0a          VSTR     s0,[r4,#0x28]         ;513
0001f6  e732              B        |L2.94|
                  |L2.504|
0001f8  edd30a00          VLDR     s1,[r3,#0]            ;500
0001fc  ee600a88          VMUL.F32 s1,s1,s16             ;500
000200  ee801aa8          VDIV.F32 s2,s1,s17             ;500
000204  edd40a0a          VLDR     s1,[r4,#0x28]         ;500
000208  ee710a20          VADD.F32 s1,s2,s1              ;500
00020c  edc40a0a          VSTR     s1,[r4,#0x28]         ;500
000210  e7e8              B        |L2.484|
                  |L2.530|
000212  ed950a00          VLDR     s0,[r5,#0]            ;511
000216  ee200a08          VMUL.F32 s0,s0,s16             ;511
00021a  eec00a28          VDIV.F32 s1,s0,s17             ;511
00021e  ed940a0a          VLDR     s0,[r4,#0x28]         ;511
000222  ee300a80          VADD.F32 s0,s1,s0              ;511
000226  ed840a0a          VSTR     s0,[r4,#0x28]         ;511
00022a  e718              B        |L2.94|
00022c  e7ff              B        |L2.558|
                  |L2.558|
00022e  491e              LDR      r1,|L2.680|
000230  7809              LDRB     r1,[r1,#0]            ;519  ; oct_sw
000232  2901              CMP      r1,#1                 ;519
000234  d191              BNE      |L2.346|
000236  7800              LDRB     r0,[r0,#0]            ;521  ; alert_flag
000238  2801              CMP      r0,#1                 ;521
00023a  d18e              BNE      |L2.346|
00023c  78a0              LDRB     r0,[r4,#2]            ;523  ; calert
00023e  1c40              ADDS     r0,r0,#1              ;523
000240  70a0              STRB     r0,[r4,#2]            ;523
000242  78a0              LDRB     r0,[r4,#2]            ;524  ; calert
000244  2803              CMP      r0,#3                 ;524
000246  d188              BNE      |L2.346|
000248  4918              LDR      r1,|L2.684|
00024a  2001              MOVS     r0,#1                 ;526
00024c  7008              STRB     r0,[r1,#0]            ;526
00024e  70a6              STRB     r6,[r4,#2]            ;527
000250  e705              B        |L2.94|
;;;539    
                          ENDP

000252  0000              DCW      0x0000
                  |L2.596|
                          DCD      0x40000400
                  |L2.600|
                          DCD      page_sw
                  |L2.604|
                          DCD      pow_sw
                  |L2.608|
                          DCD      DISS_POW_Current
                  |L2.612|
                          DCD      DISS_Current
                  |L2.616|
                          DCD      alert_flag
                  |L2.620|
                          DCD      cdc_sw
                  |L2.624|
                          DCD      load_sw
                  |L2.628|
                          DCD      mode_sw
                  |L2.632|
000278  447a0000          DCFS     0x447a0000 ; 1000
                  |L2.636|
00027c  45610000          DCFS     0x45610000 ; 3600
                  |L2.640|
000280  00000000          DCFS     0x00000000 ; 0
                  |L2.644|
                          DCD      ||.data||
                  |L2.648|
                          DCD      second
                  |L2.652|
                          DCD      minute
                  |L2.656|
                          DCD      hour
                  |L2.660|
                          DCD      second1
                  |L2.664|
                          DCD      minute1
                  |L2.668|
                          DCD      hour1
                  |L2.672|
                          DCD      t_onoff
                  |L2.676|
                          DCD      0x40020000
                  |L2.680|
                          DCD      oct_sw
                  |L2.684|
                          DCD      ocstop

                          AREA ||i.TIM3_Int_Init||, CODE, READONLY, ALIGN=2

                  TIM3_Int_Init PROC
;;;369    //?o???¡¦??? 3!
;;;370    void TIM3_Int_Init(u16 arr,u16 psc)
000000  b57f              PUSH     {r0-r6,lr}
;;;371    {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;372        TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
;;;373        NVIC_InitTypeDef NVIC_InitStructure;
;;;374        
;;;375        RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3,ENABLE); //¨´?? TIM3 ??
000006  2101              MOVS     r1,#1
000008  2002              MOVS     r0,#2
00000a  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;376        TIM_TimeBaseInitStructure.TIM_Period = arr; //??????
00000e  9402              STR      r4,[sp,#8]
;;;377        TIM_TimeBaseInitStructure.TIM_Prescaler=psc; //?????
000010  f8ad5004          STRH     r5,[sp,#4]
;;;378        TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; //§Ó?????
000014  2000              MOVS     r0,#0
000016  f8ad0006          STRH     r0,[sp,#6]
;;;379        TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1;
00001a  f8ad000c          STRH     r0,[sp,#0xc]
;;;380        TIM_TimeBaseInit(TIM3,&TIM_TimeBaseInitStructure);// ¨²?????? TIM3
00001e  4c0e              LDR      r4,|L3.88|
000020  a901              ADD      r1,sp,#4
000022  4620              MOV      r0,r4
000024  f7fffffe          BL       TIM_TimeBaseInit
;;;381        TIM_ITConfig(TIM3,TIM_IT_Update,ENABLE); //?????? 3 ?§ä??
000028  2201              MOVS     r2,#1
00002a  4611              MOV      r1,r2
00002c  4620              MOV      r0,r4
00002e  f7fffffe          BL       TIM_ITConfig
;;;382        NVIC_InitStructure.NVIC_IRQChannel=TIM3_IRQn; //??? 3 ??
000032  211d              MOVS     r1,#0x1d
000034  f88d1000          STRB     r1,[sp,#0]
;;;383        NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=0x01; //????? 1
000038  2101              MOVS     r1,#1
00003a  f88d1001          STRB     r1,[sp,#1]
;;;384        NVIC_InitStructure.NVIC_IRQChannelSubPriority=0x03; //§¾???? 3
00003e  2203              MOVS     r2,#3
000040  f88d2002          STRB     r2,[sp,#2]
;;;385        NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;
000044  f88d1003          STRB     r1,[sp,#3]
;;;386        NVIC_Init(&NVIC_InitStructure);// ¨¹??? NVIC
000048  4668              MOV      r0,sp
00004a  f7fffffe          BL       NVIC_Init
;;;387        TIM_Cmd(TIM3,ENABLE); //Y????? 3
00004e  2101              MOVS     r1,#1
000050  4620              MOV      r0,r4
000052  f7fffffe          BL       TIM_Cmd
;;;388    }
000056  bd7f              POP      {r0-r6,pc}
;;;389    //??? 3 ??????
                          ENDP

                  |L3.88|
                          DCD      0x40000400

                          AREA ||i.TIM4_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM4_IRQHandler PROC
;;;89     //??? 3 ??????
;;;90     void TIM4_IRQHandler(void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;91     {
000004  ed2d8b06          VPUSH    {d8-d10}
;;;92         static vu16 resetcount;
;;;93         static vu8 read1963;
;;;94         static vu16 scancount;
;;;95         static vu16 uocount;
;;;96         static vu16 powcount;
;;;97         static vu16 powflag;
;;;98         static vu16 finishflag;
;;;99         static float crec1,crec2;
;;;100        u8 crec[6];
;;;101        u8 *csend;
;;;102        static u8 *sendbuf;
;;;103        u8 sendlen;
;;;104        static u16 recrc;
;;;105        static u16 scrc;
;;;106        u8 i;
;;;107    //     static float crec1,crec2;
;;;108        
;;;109        if(TIM_GetITStatus(TIM4,TIM_IT_Update)==SET) //????
000008  2101              MOVS     r1,#1
00000a  4cfe              LDR      r4,|L4.1028|
00000c  4620              MOV      r0,r4
00000e  f7fffffe          BL       TIM_GetITStatus
000012  2801              CMP      r0,#1
000014  d17d              BNE      |L4.274|
;;;110        {
;;;111            TIM_ClearITPendingBit(TIM4,TIM_IT_Update); //Çå³ýÖÐ¶Ï±êÖ¾Î»
000016  2101              MOVS     r1,#1
000018  4620              MOV      r0,r4
00001a  f7fffffe          BL       TIM_ClearITPendingBit
;;;112            
;;;113            if(page_sw != face_starter)
00001e  4cfa              LDR      r4,|L4.1032|
000020  7820              LDRB     r0,[r4,#0]  ; page_sw
;;;114            {
;;;115                 if(resetflag == 1)
;;;116                 {
;;;117                     if(resetcount == 3000)
;;;118                     {
;;;119    //                     sLCD_GPIO_Config();
;;;120                         sLCD_Init();
;;;121    //                     sLCD_WR_REG(0xf1);
;;;122                         GUI_Init();
;;;123                         if(page_sw == face_menu)
;;;124                         {
;;;125                             ResetPow();
;;;126                         }else if(page_sw == face_cdc){
;;;127                             ResetCDC();
;;;128                         }else if(page_sw == face_r){
;;;129                             ResetR();
;;;130                         }else if(page_sw == face_load){
;;;131                             ResetLoad();
;;;132                         }else if(page_sw == face_graph){
;;;133                             ResetG();
;;;134                         }else if(page_sw == face_set){
;;;135                             ResetSET();
;;;136                         }
;;;137    //                     resdone = 1;
;;;138    //                     resetflag = 0;
;;;139                         resetcount = 0;
000022  2500              MOVS     r5,#0
000024  f8dfa3e4          LDR      r10,|L4.1036|
000028  f64038b8          MOV      r8,#0xbb8             ;117
00002c  2806              CMP      r0,#6                 ;113
00002e  d036              BEQ      |L4.158|
000030  f89a0003          LDRB     r0,[r10,#3]           ;115  ; resetflag
000034  2801              CMP      r0,#1                 ;115
000036  d132              BNE      |L4.158|
000038  f8ba0004          LDRH     r0,[r10,#4]           ;117  ; resetcount
00003c  4540              CMP      r0,r8                 ;117
00003e  d129              BNE      |L4.148|
000040  f7fffffe          BL       sLCD_Init
000044  f7fffffe          BL       GUI_Init
000048  7820              LDRB     r0,[r4,#0]            ;123  ; page_sw
00004a  2802              CMP      r0,#2                 ;123
00004c  d00e              BEQ      |L4.108|
00004e  7820              LDRB     r0,[r4,#0]            ;126  ; page_sw
000050  2801              CMP      r0,#1                 ;126
000052  d00e              BEQ      |L4.114|
000054  7820              LDRB     r0,[r4,#0]            ;128  ; page_sw
000056  2803              CMP      r0,#3                 ;128
000058  d00e              BEQ      |L4.120|
00005a  7820              LDRB     r0,[r4,#0]            ;130  ; page_sw
00005c  2804              CMP      r0,#4                 ;130
00005e  d00e              BEQ      |L4.126|
000060  7820              LDRB     r0,[r4,#0]            ;132  ; page_sw
000062  b178              CBZ      r0,|L4.132|
000064  7820              LDRB     r0,[r4,#0]            ;134  ; page_sw
000066  2805              CMP      r0,#5                 ;134
000068  d00f              BEQ      |L4.138|
00006a  e010              B        |L4.142|
                  |L4.108|
00006c  f7fffffe          BL       ResetPow
000070  e00d              B        |L4.142|
                  |L4.114|
000072  f7fffffe          BL       ResetCDC
000076  e00a              B        |L4.142|
                  |L4.120|
000078  f7fffffe          BL       ResetR
00007c  e007              B        |L4.142|
                  |L4.126|
00007e  f7fffffe          BL       ResetLoad
000082  e004              B        |L4.142|
                  |L4.132|
000084  f7fffffe          BL       ResetG
000088  e001              B        |L4.142|
                  |L4.138|
00008a  f7fffffe          BL       ResetSET
                  |L4.142|
00008e  f8aa5004          STRH     r5,[r10,#4]
000092  e004              B        |L4.158|
                  |L4.148|
;;;140                     }else{
;;;141                         resetcount++;
000094  f8ba0004          LDRH     r0,[r10,#4]  ; resetcount
000098  1c40              ADDS     r0,r0,#1
00009a  f8aa0004          STRH     r0,[r10,#4]
                  |L4.158|
;;;142                     }                
;;;143                 }
;;;144             }
;;;145             
;;;146            if(page_sw == face_r)
00009e  7820              LDRB     r0,[r4,#0]  ; page_sw
;;;147            {
;;;148                if(oct_sw == oct_on)
;;;149                {
;;;150                    OC_CHECK();
;;;151                    if(oct_sw == oct_on)
;;;152                    {
;;;153                        stepcount ++;
;;;154                        if(stepcount == steptime*10)
;;;155                        {
;;;156                            OC_ADD();
;;;157                            stepcount = 0;
;;;158                        }
;;;159                    }
;;;160                }
;;;161                if(rpow == 1)
;;;162                {
;;;163                    if(powcount < 1000)
;;;164                    {
;;;165                        SET_Voltage =3000;
;;;166                        SET_Current = 1000;
;;;167                        GPIO_SetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOFF
;;;168                        GPIO_ResetBits(GPIOC,GPIO_Pin_13);//´ò¿ªµçÔ´Êä³ö¼ÌµçÆ÷
;;;169                        GPIO_SetBits(GPIOC,GPIO_Pin_1);//´ò¿ªµçÔ´Êä³ö
;;;170                        powcount++;
;;;171                    }else{
;;;172                        powcount = 0;
;;;173                        rpow = 0;
;;;174                        short_flag = 1;
;;;175                        IO_OFF();
;;;176                    }                    
;;;177                }
;;;178                if(short_flag == 1)
;;;179                {
;;;180                    if(oc_mode == 0)
;;;181                    {
;;;182                        SET_Current_Laod = (int)(oc_data*1000)+8000;
;;;183                        flag_Load_CC = 1;
;;;184                        GPIO_ResetBits(GPIOC,GPIO_Pin_10);//CC
;;;185                        GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
;;;186                    } else if(oc_mode == 1){
;;;187                        GPIO_SetBits(GPIOC,GPIO_Pin_10);//CV
;;;188                        flag_Load_CC = 0;
;;;189                        GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
;;;190                    }
;;;191                    if((v - DISS_Voltage) > v*0.6)
0000a0  ed9fabdb          VLDR     d10,|L4.1040|
0000a4  eddf9adc          VLDR     s19,|L4.1048|
0000a8  2701              MOVS     r7,#1                 ;109
0000aa  f8df9370          LDR      r9,|L4.1052|
0000ae  4cdc              LDR      r4,|L4.1056|
0000b0  4edc              LDR      r6,|L4.1060|
0000b2  f44f7b7a          MOV      r11,#0x3e8            ;163
0000b6  2803              CMP      r0,#3                 ;146
0000b8  d17d              BNE      |L4.438|
0000ba  48db              LDR      r0,|L4.1064|
0000bc  7800              LDRB     r0,[r0,#0]            ;148  ; oct_sw
0000be  2801              CMP      r0,#1                 ;148
0000c0  d115              BNE      |L4.238|
0000c2  f7fffffe          BL       OC_CHECK
0000c6  48d8              LDR      r0,|L4.1064|
0000c8  7800              LDRB     r0,[r0,#0]            ;151  ; oct_sw
0000ca  2801              CMP      r0,#1                 ;151
0000cc  d10f              BNE      |L4.238|
0000ce  49d7              LDR      r1,|L4.1068|
0000d0  8808              LDRH     r0,[r1,#0]            ;153  ; stepcount
0000d2  1c40              ADDS     r0,r0,#1              ;153
0000d4  8008              STRH     r0,[r1,#0]            ;153
0000d6  48d6              LDR      r0,|L4.1072|
0000d8  8800              LDRH     r0,[r0,#0]            ;154  ; steptime
0000da  8809              LDRH     r1,[r1,#0]            ;154  ; stepcount
0000dc  eb000080          ADD      r0,r0,r0,LSL #2       ;154
0000e0  ebb10f40          CMP      r1,r0,LSL #1          ;154
0000e4  d103              BNE      |L4.238|
0000e6  f7fffffe          BL       OC_ADD
0000ea  48d0              LDR      r0,|L4.1068|
0000ec  8005              STRH     r5,[r0,#0]            ;157
                  |L4.238|
0000ee  48d1              LDR      r0,|L4.1076|
0000f0  7801              LDRB     r1,[r0,#0]            ;161  ; rpow
0000f2  2901              CMP      r1,#1                 ;161
0000f4  d124              BNE      |L4.320|
0000f6  f8ba1008          LDRH     r1,[r10,#8]           ;163  ; powcount
0000fa  4559              CMP      r1,r11                ;163
0000fc  d219              BCS      |L4.306|
0000fe  f8c48004          STR      r8,[r4,#4]            ;165  ; Run_Control
000102  f8c4b008          STR      r11,[r4,#8]           ;166  ; Run_Control
000106  f44f4100          MOV      r1,#0x8000            ;167
00010a  48cb              LDR      r0,|L4.1080|
00010c  f7fffffe          BL       GPIO_SetBits
000110  e000              B        |L4.276|
                  |L4.274|
000112  e1de              B        |L4.1234|
                  |L4.276|
000114  f44f5100          MOV      r1,#0x2000            ;168
000118  4630              MOV      r0,r6                 ;168
00011a  f7fffffe          BL       GPIO_ResetBits
00011e  2102              MOVS     r1,#2                 ;169
000120  4630              MOV      r0,r6                 ;169
000122  f7fffffe          BL       GPIO_SetBits
000126  f8ba0008          LDRH     r0,[r10,#8]           ;170  ; powcount
00012a  1c40              ADDS     r0,r0,#1              ;170
00012c  f8aa0008          STRH     r0,[r10,#8]           ;170
000130  e006              B        |L4.320|
                  |L4.306|
000132  f8aa5008          STRH     r5,[r10,#8]           ;172
000136  7005              STRB     r5,[r0,#0]            ;173
000138  48c0              LDR      r0,|L4.1084|
00013a  7007              STRB     r7,[r0,#0]            ;174
00013c  f7fffffe          BL       IO_OFF
                  |L4.320|
000140  48be              LDR      r0,|L4.1084|
000142  7800              LDRB     r0,[r0,#0]            ;178  ; short_flag
000144  2801              CMP      r0,#1                 ;178
000146  d15f              BNE      |L4.520|
000148  48bd              LDR      r0,|L4.1088|
00014a  7801              LDRB     r1,[r0,#0]            ;180  ; oc_mode
00014c  b119              CBZ      r1,|L4.342|
00014e  7800              LDRB     r0,[r0,#0]            ;186  ; oc_mode
000150  2801              CMP      r0,#1                 ;186
000152  d01d              BEQ      |L4.400|
000154  e02c              B        |L4.432|
                  |L4.342|
000156  48bb              LDR      r0,|L4.1092|
000158  ed900a00          VLDR     s0,[r0,#0]            ;182
00015c  ee200a29          VMUL.F32 s0,s0,s19             ;182
000160  eebd0ac0          VCVT.S32.F32 s0,s0                 ;182
000164  ee100a10          VMOV     r0,s0                 ;182
000168  f50050fa          ADD      r0,r0,#0x1f40         ;182
00016c  6120              STR      r0,[r4,#0x10]         ;182  ; Run_Control
00016e  f8d90000          LDR      r0,[r9,#0]            ;183  ; flagD
000172  f0400080          ORR      r0,r0,#0x80           ;183
000176  f8c90000          STR      r0,[r9,#0]            ;183  ; flagD
00017a  f44f6180          MOV      r1,#0x400             ;184
00017e  4630              MOV      r0,r6                 ;184
000180  f7fffffe          BL       GPIO_ResetBits
000184  f44f4100          MOV      r1,#0x8000            ;185
000188  48ab              LDR      r0,|L4.1080|
00018a  f7fffffe          BL       GPIO_ResetBits
00018e  e00f              B        |L4.432|
                  |L4.400|
000190  f44f6180          MOV      r1,#0x400             ;187
000194  4630              MOV      r0,r6                 ;187
000196  f7fffffe          BL       GPIO_SetBits
00019a  f8d90000          LDR      r0,[r9,#0]            ;188  ; flagD
00019e  f0200080          BIC      r0,r0,#0x80           ;188
0001a2  f8c90000          STR      r0,[r9,#0]            ;188  ; flagD
0001a6  f44f4100          MOV      r1,#0x8000            ;189
0001aa  48a3              LDR      r0,|L4.1080|
0001ac  f7fffffe          BL       GPIO_ResetBits
                  |L4.432|
0001b0  48a5              LDR      r0,|L4.1096|
0001b2  6800              LDR      r0,[r0,#0]  ; v
0001b4  e000              B        |L4.440|
                  |L4.438|
0001b6  e027              B        |L4.520|
                  |L4.440|
0001b8  ee090a10          VMOV     s18,r0
0001bc  f7fffffe          BL       __aeabi_f2d
0001c0  ec532b1a          VMOV     r2,r3,d10
0001c4  f7fffffe          BL       __aeabi_dmul
0001c8  ec410b18          VMOV     d8,r0,r1
0001cc  489f              LDR      r0,|L4.1100|
0001ce  ed900a00          VLDR     s0,[r0,#0]
0001d2  ee390a40          VSUB.F32 s0,s18,s0
0001d6  ee100a10          VMOV     r0,s0
0001da  f7fffffe          BL       __aeabi_f2d
0001de  ec532b18          VMOV     r2,r3,d8
0001e2  f7fffffe          BL       __aeabi_cdrcmple
0001e6  d20b              BCS      |L4.512|
;;;192                    {
;;;193                        GPIO_SetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOFF
0001e8  f44f4100          MOV      r1,#0x8000
0001ec  4892              LDR      r0,|L4.1080|
0001ee  f7fffffe          BL       GPIO_SetBits
;;;194                        short_flag = 0;
0001f2  4892              LDR      r0,|L4.1084|
0001f4  7005              STRB     r5,[r0,#0]
;;;195                        short_finish = 1;
0001f6  4896              LDR      r0,|L4.1104|
0001f8  7007              STRB     r7,[r0,#0]
;;;196                        SET_Current_Laod = set_init_c;
0001fa  6da0              LDR      r0,[r4,#0x58]  ; Run_Control
0001fc  6120              STR      r0,[r4,#0x10]  ; Run_Control
0001fe  e003              B        |L4.520|
                  |L4.512|
;;;197                    }else{
;;;198                        short_time++;                
000200  4994              LDR      r1,|L4.1108|
000202  8808              LDRH     r0,[r1,#0]  ; short_time
000204  1c40              ADDS     r0,r0,#1
000206  8008              STRH     r0,[r1,#0]
                  |L4.520|
;;;199                    }
;;;200                }
;;;201                
;;;202            }
;;;203    //         if(page_sw == face_load)
;;;204    //         {
;;;205    //             if(c_rec == 1)
;;;206    //             {
;;;207    //                 crec2 = crec1;
;;;208    //                 crec1 = DISS_Current;
;;;209    //                 if(crec2 > crec1)
;;;210    //                 {
;;;211    //                     watch = crec2;
;;;212    //                     c_rec = 0;
;;;213    //                     crec2 = crec1 = 0;
;;;214    //                 }
;;;215    //             }
;;;216    //         }
;;;217            if(usartocflag == 1)
000208  f89a0000          LDRB     r0,[r10,#0]  ; usartocflag
00020c  2801              CMP      r0,#1
00020e  d162              BNE      |L4.726|
;;;218            {
;;;219    
;;;220                if(flag_Load_CC == 1)
000210  f8d90000          LDR      r0,[r9,#0]  ; flagD
000214  0600              LSLS     r0,r0,#24
000216  d50a              BPL      |L4.558|
;;;221                {              
;;;222                    GPIO_ResetBits(GPIOC,GPIO_Pin_10);//CC
000218  f44f6180          MOV      r1,#0x400
00021c  4630              MOV      r0,r6
00021e  f7fffffe          BL       GPIO_ResetBits
;;;223                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
000222  f44f4100          MOV      r1,#0x8000
000226  4884              LDR      r0,|L4.1080|
000228  f7fffffe          BL       GPIO_ResetBits
00022c  e010              B        |L4.592|
                  |L4.558|
;;;224                }else if(flag_Load_CC == 0){
;;;225                    SET_Voltage_Laod = 0;
00022e  60e5              STR      r5,[r4,#0xc]  ; Run_Control
;;;226                    GPIO_SetBits(GPIOC,GPIO_Pin_10);//CV
000230  f44f6180          MOV      r1,#0x400
000234  4630              MOV      r0,r6
000236  f7fffffe          BL       GPIO_SetBits
;;;227                    flag_Load_CC = 0;
00023a  f8d90000          LDR      r0,[r9,#0]  ; flagD
00023e  f0200080          BIC      r0,r0,#0x80
000242  f8c90000          STR      r0,[r9,#0]  ; flagD
;;;228                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
000246  f44f4100          MOV      r1,#0x8000
00024a  487b              LDR      r0,|L4.1080|
00024c  f7fffffe          BL       GPIO_ResetBits
                  |L4.592|
;;;229                }
;;;230                crec2 = crec1;
000250  ed9a0a05          VLDR     s0,[r10,#0x14]
000254  ed8a0a06          VSTR     s0,[r10,#0x18]
;;;231                crec1 = DISS_Current;
000258  487f              LDR      r0,|L4.1112|
00025a  edd00a00          VLDR     s1,[r0,#0]
00025e  edca0a05          VSTR     s1,[r10,#0x14]
;;;232                if(crec1 < crec2 && crec2 > 0.3)
000262  eef40ac0          VCMPE.F32 s1,s0
000266  eef1fa10          VMRS     APSR_nzcv,FPSCR
00026a  d227              BCS      |L4.700|
00026c  ee100a10          VMOV     r0,s0
000270  497a              LDR      r1,|L4.1116|
000272  4288              CMP      r0,r1
000274  db22              BLT      |L4.700|
;;;233                {     
;;;234                    oc_data = crec2;
000276  4873              LDR      r0,|L4.1092|
000278  ed800a00          VSTR     s0,[r0,#0]
;;;235                    g_tModS.TxBuf[13] = (int)(oc_data*1000)>>8;
00027c  ee200a29          VMUL.F32 s0,s0,s19
000280  4977              LDR      r1,|L4.1120|
000282  eebd0ac0          VCVT.S32.F32 s0,s0
000286  ee100a10          VMOV     r0,s0
00028a  1200              ASRS     r0,r0,#8
00028c  7008              STRB     r0,[r1,#0]
;;;236                    g_tModS.TxBuf[14] = (int)(oc_data*1000);
00028e  ee100a10          VMOV     r0,s0
000292  7048              STRB     r0,[r1,#1]
;;;237                    SET_Current_Laod = set_init_c;
000294  6da0              LDR      r0,[r4,#0x58]  ; Run_Control
000296  6120              STR      r0,[r4,#0x10]  ; Run_Control
;;;238                    GPIO_SetBits(GPIOA,GPIO_Pin_15);//å…³é—­è´Ÿè½½ 
000298  f44f4100          MOV      r1,#0x8000
00029c  4866              LDR      r0,|L4.1080|
00029e  f7fffffe          BL       GPIO_SetBits
;;;239    //                MODS_SendWithCRC(g_tModS.TxBuf, g_tModS.TxCount);
;;;240                    t_onoff = 0;
0002a2  4870              LDR      r0,|L4.1124|
0002a4  7005              STRB     r5,[r0,#0]
;;;241                    usartocflag = 0;
0002a6  f88a5000          STRB     r5,[r10,#0]
;;;242                    crec1 = 0;
0002aa  ed9f0a6f          VLDR     s0,|L4.1128|
0002ae  ed8a0a05          VSTR     s0,[r10,#0x14]
;;;243                    crec2 = 0;
0002b2  ed8a0a06          VSTR     s0,[r10,#0x18]
;;;244                    powflag = 1;
0002b6  f8aa700a          STRH     r7,[r10,#0xa]
0002ba  e00c              B        |L4.726|
                  |L4.700|
;;;245                    
;;;246                }else{
;;;247                    if(flag_Load_CC == 1)
0002bc  f8d90000          LDR      r0,[r9,#0]  ; flagD
0002c0  0600              LSLS     r0,r0,#24
0002c2  d508              BPL      |L4.726|
;;;248                    {
;;;249                        if(uocount == 10)
0002c4  f8ba0006          LDRH     r0,[r10,#6]  ; uocount
0002c8  280a              CMP      r0,#0xa
0002ca  d009              BEQ      |L4.736|
;;;250                        {
;;;251                            SET_Current_Laod = SET_Current_Laod + 10;
;;;252                            uocount = 0;
;;;253                        }else{
;;;254                            uocount++;
0002cc  f8ba0006          LDRH     r0,[r10,#6]  ; uocount
0002d0  1c40              ADDS     r0,r0,#1
0002d2  f8aa0006          STRH     r0,[r10,#6]
                  |L4.726|
;;;255                        }
;;;256                    }                    
;;;257                }
;;;258            }
;;;259            if(powflag == 1)
0002d6  f8ba000a          LDRH     r0,[r10,#0xa]  ; powflag
0002da  2801              CMP      r0,#1
0002dc  d006              BEQ      |L4.748|
0002de  e030              B        |L4.834|
                  |L4.736|
0002e0  6920              LDR      r0,[r4,#0x10]         ;251  ; Run_Control
0002e2  300a              ADDS     r0,r0,#0xa            ;251
0002e4  6120              STR      r0,[r4,#0x10]         ;251  ; Run_Control
0002e6  f8aa5006          STRH     r5,[r10,#6]           ;252
0002ea  e7f4              B        |L4.726|
                  |L4.748|
;;;260            {
;;;261                if(powcount < 1000)
0002ec  f8ba0008          LDRH     r0,[r10,#8]  ; powcount
0002f0  4558              CMP      r0,r11
0002f2  d217              BCS      |L4.804|
;;;262                {
;;;263                    SET_Voltage =3000;
0002f4  f8c48004          STR      r8,[r4,#4]  ; Run_Control
;;;264                    SET_Current = 1000;
0002f8  f8c4b008          STR      r11,[r4,#8]  ; Run_Control
;;;265                    GPIO_SetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOFF
0002fc  f44f4100          MOV      r1,#0x8000
000300  484d              LDR      r0,|L4.1080|
000302  f7fffffe          BL       GPIO_SetBits
;;;266                    GPIO_ResetBits(GPIOC,GPIO_Pin_13);//´ò¿ªµçÔ´Êä³ö¼ÌµçÆ÷
000306  f44f5100          MOV      r1,#0x2000
00030a  4630              MOV      r0,r6
00030c  f7fffffe          BL       GPIO_ResetBits
;;;267                    GPIO_SetBits(GPIOC,GPIO_Pin_1);//´ò¿ªµçÔ´Êä³ö
000310  2102              MOVS     r1,#2
000312  4630              MOV      r0,r6
000314  f7fffffe          BL       GPIO_SetBits
;;;268                    powcount++;
000318  f8ba0008          LDRH     r0,[r10,#8]  ; powcount
00031c  1c40              ADDS     r0,r0,#1
00031e  f8aa0008          STRH     r0,[r10,#8]
000322  e00e              B        |L4.834|
                  |L4.804|
;;;269    //                 shortv = DISS_Voltage;
;;;270                }else{
;;;271                    powcount = 0;
000324  f8aa5008          STRH     r5,[r10,#8]
;;;272                    powflag = 0;
000328  f8aa500a          STRH     r5,[r10,#0xa]
;;;273                    GPIO_ResetBits(GPIOC,GPIO_Pin_1);//¹Ø±ÕµçÔ´Êä³ö
00032c  2102              MOVS     r1,#2
00032e  4630              MOV      r0,r6
000330  f7fffffe          BL       GPIO_ResetBits
;;;274                    GPIO_SetBits(GPIOC,GPIO_Pin_13);//¹Ø±ÕµçÔ´Êä³ö¼ÌµçÆ÷ 
000334  f44f5100          MOV      r1,#0x2000
000338  4630              MOV      r0,r6
00033a  f7fffffe          BL       GPIO_SetBits
;;;275                    usartshortflag = 1;
00033e  f88a7001          STRB     r7,[r10,#1]
                  |L4.834|
;;;276                    
;;;277                }
;;;278            }
;;;279            if(usartshortflag == 1)
000342  f89a0001          LDRB     r0,[r10,#1]  ; usartshortflag
000346  2801              CMP      r0,#1
000348  d15a              BNE      |L4.1024|
;;;280            {
;;;281                if(flag_Load_CC == 1)
00034a  f8d90000          LDR      r0,[r9,#0]  ; flagD
00034e  0600              LSLS     r0,r0,#24
000350  d522              BPL      |L4.920|
;;;282                {
;;;283                    SET_Current_Laod = (int)(oc_data*1000)+5000; 
000352  483c              LDR      r0,|L4.1092|
000354  f2413188          MOV      r1,#0x1388
000358  ed900a00          VLDR     s0,[r0,#0]
00035c  ee200a29          VMUL.F32 s0,s0,s19
000360  eebd0ac0          VCVT.S32.F32 s0,s0
000364  ee100a10          VMOV     r0,s0
000368  4408              ADD      r0,r0,r1
00036a  6120              STR      r0,[r4,#0x10]  ; Run_Control
;;;284                    GPIO_ResetBits(GPIOC,GPIO_Pin_10);//CC
00036c  f44f6180          MOV      r1,#0x400
000370  4630              MOV      r0,r6
000372  f7fffffe          BL       GPIO_ResetBits
;;;285                    flag_Load_CC = 1;                              
000376  f8d90000          LDR      r0,[r9,#0]  ; flagD
00037a  f0400080          ORR      r0,r0,#0x80
00037e  f8c90000          STR      r0,[r9,#0]  ; flagD
;;;286                    GPIO_ResetBits(GPIOC,GPIO_Pin_10);//CC
000382  f44f6180          MOV      r1,#0x400
000386  4630              MOV      r0,r6
000388  f7fffffe          BL       GPIO_ResetBits
;;;287                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
00038c  f44f4100          MOV      r1,#0x8000
000390  4829              LDR      r0,|L4.1080|
000392  f7fffffe          BL       GPIO_ResetBits
000396  e010              B        |L4.954|
                  |L4.920|
;;;288                }else if(flag_Load_CC == 0){
;;;289                    SET_Voltage_Laod = 0;
000398  60e5              STR      r5,[r4,#0xc]  ; Run_Control
;;;290                    GPIO_SetBits(GPIOC,GPIO_Pin_10);//CV
00039a  f44f6180          MOV      r1,#0x400
00039e  4630              MOV      r0,r6
0003a0  f7fffffe          BL       GPIO_SetBits
;;;291                    flag_Load_CC = 0;
0003a4  f8d90000          LDR      r0,[r9,#0]  ; flagD
0003a8  f0200080          BIC      r0,r0,#0x80
0003ac  f8c90000          STR      r0,[r9,#0]  ; flagD
;;;292                    GPIO_ResetBits(GPIOA,GPIO_Pin_15);//µç×Ó¸ºÔØOn
0003b0  f44f4100          MOV      r1,#0x8000
0003b4  4820              LDR      r0,|L4.1080|
0003b6  f7fffffe          BL       GPIO_ResetBits
                  |L4.954|
;;;293                }
;;;294                if((shortv - DISS_Voltage) > shortv*0.6)
0003ba  f8da0038          LDR      r0,[r10,#0x38]  ; shortv
0003be  ee090a10          VMOV     s18,r0
0003c2  f7fffffe          BL       __aeabi_f2d
0003c6  ec532b1a          VMOV     r2,r3,d10
0003ca  f7fffffe          BL       __aeabi_dmul
0003ce  ec410b18          VMOV     d8,r0,r1
0003d2  481e              LDR      r0,|L4.1100|
0003d4  ed900a00          VLDR     s0,[r0,#0]
0003d8  ee390a40          VSUB.F32 s0,s18,s0
0003dc  ee100a10          VMOV     r0,s0
0003e0  f7fffffe          BL       __aeabi_f2d
0003e4  ec532b18          VMOV     r2,r3,d8
0003e8  f7fffffe          BL       __aeabi_cdrcmple
0003ec  d253              BCS      |L4.1174|
;;;295                {
;;;296                    IO_OFF();
0003ee  f7fffffe          BL       IO_OFF
;;;297                    usartshortflag = 0;               
0003f2  f88a5001          STRB     r5,[r10,#1]
;;;298                    g_tModS.TxBuf[17] = (short_time/10)>>8;
0003f6  f8df905c          LDR      r9,|L4.1108|
0003fa  f8b90000          LDRH     r0,[r9,#0]  ; short_time
0003fe  e035              B        |L4.1132|
                  |L4.1024|
000400  e04d              B        |L4.1182|
000402  0000              DCW      0x0000
                  |L4.1028|
                          DCD      0x40000800
                  |L4.1032|
                          DCD      page_sw
                  |L4.1036|
                          DCD      ||.data||
                  |L4.1040|
000410  33333333          DCFD     0x3fe3333333333333 ; 0.59999999999999998
000414  3fe33333
                  |L4.1048|
000418  447a0000          DCFS     0x447a0000 ; 1000
                  |L4.1052|
                          DCD      flagD
                  |L4.1056|
                          DCD      Run_Control
                  |L4.1060|
                          DCD      0x40020800
                  |L4.1064|
                          DCD      oct_sw
                  |L4.1068|
                          DCD      stepcount
                  |L4.1072|
                          DCD      steptime
                  |L4.1076|
                          DCD      rpow
                  |L4.1080|
                          DCD      0x40020000
                  |L4.1084|
                          DCD      short_flag
                  |L4.1088|
                          DCD      oc_mode
                  |L4.1092|
                          DCD      oc_data
                  |L4.1096|
                          DCD      v
                  |L4.1100|
                          DCD      DISS_Voltage
                  |L4.1104|
                          DCD      short_finish
                  |L4.1108|
                          DCD      short_time
                  |L4.1112|
                          DCD      DISS_Current
                  |L4.1116|
                          DCD      0x3e99999a
                  |L4.1120|
                          DCD      g_tModS+0x2b
                  |L4.1124|
                          DCD      t_onoff
                  |L4.1128|
000468  00000000          DCFS     0x00000000 ; 0
                  |L4.1132|
00046c  210a              MOVS     r1,#0xa
00046e  fbb0f0f1          UDIV     r0,r0,r1
000472  0a02              LSRS     r2,r0,#8
000474  481f              LDR      r0,|L4.1268|
000476  7002              STRB     r2,[r0,#0]
;;;299                    g_tModS.TxBuf[18] = (short_time/10);
000478  f8b92000          LDRH     r2,[r9,#0]  ; short_time
00047c  fbb2f1f1          UDIV     r1,r2,r1
000480  7041              STRB     r1,[r0,#1]
;;;300                    MODS_SendWithCRC(g_tModS.TxBuf, g_tModS.TxCount);
000482  f8901073          LDRB     r1,[r0,#0x73]  ; g_tModS
000486  3811              SUBS     r0,r0,#0x11
000488  f7fffffe          BL       MODS_SendWithCRC
;;;301                    finishflag=1;
00048c  f8aa700c          STRH     r7,[r10,#0xc]
;;;302                    short_time = 0;
000490  f8a95000          STRH     r5,[r9,#0]
000494  e003              B        |L4.1182|
                  |L4.1174|
;;;303                }else{
;;;304                    short_time++;                
000496  4818              LDR      r0,|L4.1272|
000498  8801              LDRH     r1,[r0,#0]  ; short_time
00049a  1c49              ADDS     r1,r1,#1
00049c  8001              STRH     r1,[r0,#0]
                  |L4.1182|
;;;305                }
;;;306            }
;;;307            if(finishflag == 1)
00049e  f8ba000c          LDRH     r0,[r10,#0xc]  ; finishflag
0004a2  2801              CMP      r0,#1
0004a4  d115              BNE      |L4.1234|
;;;308            {
;;;309                if(powcount < 1000)
0004a6  f8ba0008          LDRH     r0,[r10,#8]  ; powcount
0004aa  4558              CMP      r0,r11
0004ac  d215              BCS      |L4.1242|
;;;310                {
;;;311                    SET_Voltage =3000;
0004ae  f8c48004          STR      r8,[r4,#4]  ; Run_Control
;;;312                    SET_Current = 1000;
0004b2  f8c4b008          STR      r11,[r4,#8]  ; Run_Control
;;;313                    GPIO_ResetBits(GPIOC,GPIO_Pin_13);//´ò¿ªµçÔ´Êä³ö¼ÌµçÆ÷
0004b6  f44f5100          MOV      r1,#0x2000
0004ba  4630              MOV      r0,r6
0004bc  f7fffffe          BL       GPIO_ResetBits
;;;314                    GPIO_SetBits(GPIOC,GPIO_Pin_1);//´ò¿ªµçÔ´Êä³ö
0004c0  2102              MOVS     r1,#2
0004c2  4630              MOV      r0,r6
0004c4  f7fffffe          BL       GPIO_SetBits
;;;315                    powcount++;
0004c8  f8ba0008          LDRH     r0,[r10,#8]  ; powcount
0004cc  1c40              ADDS     r0,r0,#1
0004ce  f8aa0008          STRH     r0,[r10,#8]
                  |L4.1234|
;;;316    //                 shortv = DISS_Voltage;
;;;317                }else{
;;;318                    SET_Current_Laod = 1000;
;;;319                    powcount = 0;
;;;320                    finishflag = 0;
;;;321                    IO_OFF();                
;;;322                }
;;;323            }
;;;324        }    
;;;325    }
0004d2  ecbd8b06          VPOP     {d8-d10}
0004d6  e8bd9ff0          POP      {r4-r12,pc}
                  |L4.1242|
0004da  f8c4b010          STR      r11,[r4,#0x10]        ;318  ; Run_Control
0004de  f8aa5008          STRH     r5,[r10,#8]           ;319
0004e2  f8aa500c          STRH     r5,[r10,#0xc]         ;320
0004e6  ecbd8b06          VPOP     {d8-d10}              ;321
0004ea  e8bd5ff0          POP      {r4-r12,lr}           ;321
0004ee  f7ffbffe          B.W      IO_OFF
;;;326    
                          ENDP

0004f2  0000              DCW      0x0000
                  |L4.1268|
                          DCD      g_tModS+0x2f
                  |L4.1272|
                          DCD      short_time

                          AREA ||i.TIM4_Int_Init||, CODE, READONLY, ALIGN=2

                  TIM4_Int_Init PROC
;;;69     //?o???¡¦??? 3!
;;;70     void TIM4_Int_Init(u16 arr,u16 psc)
000000  b57f              PUSH     {r0-r6,lr}
;;;71     {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;72         TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
;;;73         NVIC_InitTypeDef NVIC_InitStructure;
;;;74         
;;;75         RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM4,ENABLE); //¨´?? TIM3 ??
000006  2101              MOVS     r1,#1
000008  2004              MOVS     r0,#4
00000a  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;76         TIM_TimeBaseInitStructure.TIM_Period = arr; //??????
00000e  9402              STR      r4,[sp,#8]
;;;77         TIM_TimeBaseInitStructure.TIM_Prescaler=psc; //?????
000010  f8ad5004          STRH     r5,[sp,#4]
;;;78         TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; //§Ó?????
000014  2000              MOVS     r0,#0
000016  f8ad0006          STRH     r0,[sp,#6]
;;;79         TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1;
00001a  f8ad000c          STRH     r0,[sp,#0xc]
;;;80         TIM_TimeBaseInit(TIM4,&TIM_TimeBaseInitStructure);// ¨²?????? TIM3
00001e  4c0e              LDR      r4,|L5.88|
000020  a901              ADD      r1,sp,#4
000022  4620              MOV      r0,r4
000024  f7fffffe          BL       TIM_TimeBaseInit
;;;81         TIM_ITConfig(TIM4,TIM_IT_Update,ENABLE); //?????? 3 ?§ä??
000028  2201              MOVS     r2,#1
00002a  4611              MOV      r1,r2
00002c  4620              MOV      r0,r4
00002e  f7fffffe          BL       TIM_ITConfig
;;;82         NVIC_InitStructure.NVIC_IRQChannel=TIM4_IRQn; //??? 3 ??
000032  211e              MOVS     r1,#0x1e
000034  f88d1000          STRB     r1,[sp,#0]
;;;83         NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=0x01; //????? 1
000038  2101              MOVS     r1,#1
00003a  f88d1001          STRB     r1,[sp,#1]
;;;84         NVIC_InitStructure.NVIC_IRQChannelSubPriority=0x03; //§¾???? 3
00003e  2203              MOVS     r2,#3
000040  f88d2002          STRB     r2,[sp,#2]
;;;85         NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;
000044  f88d1003          STRB     r1,[sp,#3]
;;;86         NVIC_Init(&NVIC_InitStructure);// ¨¹??? NVIC
000048  4668              MOV      r0,sp
00004a  f7fffffe          BL       NVIC_Init
;;;87         TIM_Cmd(TIM4,ENABLE); //Y????? 3
00004e  2101              MOVS     r1,#1
000050  4620              MOV      r0,r4
000052  f7fffffe          BL       TIM_Cmd
;;;88     }
000056  bd7f              POP      {r0-r6,pc}
;;;89     //??? 3 ??????
                          ENDP

                  |L5.88|
                          DCD      0x40000800

                          AREA ||i.TIM5_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM5_IRQHandler PROC
;;;560    
;;;561    void TIM5_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;562    {
;;;563        
;;;564        if(TIM_GetITStatus(TIM5,TIM_IT_Update)==SET) //Ó§Ô¶××
000002  4c0a              LDR      r4,|L6.44|
000004  2101              MOVS     r1,#1
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       TIM_GetITStatus
00000c  2801              CMP      r0,#1
00000e  d10b              BNE      |L6.40|
;;;565        {
;;;566            TIM_ClearITPendingBit(TIM5,TIM_IT_Update); //æ¸…é™¤ä¸­æ–­æ ‡å¿—ä½?
000010  2101              MOVS     r1,#1
000012  4620              MOV      r0,r4
000014  f7fffffe          BL       TIM_ClearITPendingBit
;;;567            Tick_10ms ++;
000018  4805              LDR      r0,|L6.48|
00001a  6901              LDR      r1,[r0,#0x10]  ; Tick_10ms
00001c  1c49              ADDS     r1,r1,#1
00001e  6101              STR      r1,[r0,#0x10]  ; Tick_10ms
;;;568            MODS_Poll();
000020  e8bd4010          POP      {r4,lr}
000024  f7ffbffe          B.W      MODS_Poll
                  |L6.40|
;;;569        }
;;;570    }
000028  bd10              POP      {r4,pc}
;;;571    
                          ENDP

00002a  0000              DCW      0x0000
                  |L6.44|
                          DCD      0x40000c00
                  |L6.48|
                          DCD      ||.data||

                          AREA ||i.TIM5_Int_Init||, CODE, READONLY, ALIGN=2

                  TIM5_Int_Init PROC
;;;539    
;;;540    void TIM5_Int_Init(u16 arr,u16 psc)
000000  b57f              PUSH     {r0-r6,lr}
;;;541    {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;542        TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
;;;543        NVIC_InitTypeDef NVIC_InitStructure;
;;;544        
;;;545        RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM5,ENABLE); //Ã™Ê¹Åœ TIM3 Ê±×“
000006  2101              MOVS     r1,#1
000008  2008              MOVS     r0,#8
00000a  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;546        TIM_TimeBaseInitStructure.TIM_Period = arr; //Ø”Ö¯×˜×°Õ˜Öµ
00000e  9402              STR      r4,[sp,#8]
;;;547        TIM_TimeBaseInitStructure.TIM_Prescaler=psc; //Ö¨Ê±Ç·Ø–Æµ
000010  f8ad5004          STRH     r5,[sp,#4]
;;;548        TIM_TimeBaseInitStructure.TIM_CounterMode=TIM_CounterMode_Up; //Ð²ÊÝ†Ë½Ä£Ê½
000014  2000              MOVS     r0,#0
000016  f8ad0006          STRH     r0,[sp,#6]
;;;549        TIM_TimeBaseInitStructure.TIM_ClockDivision=TIM_CKD_DIV1;
00001a  f8ad000c          STRH     r0,[sp,#0xc]
;;;550        TIM_TimeBaseInit(TIM5,&TIM_TimeBaseInitStructure);// ÃšÔµÊ¼Û¯Ö¨Ê±Ç· TIM3
00001e  4c0e              LDR      r4,|L7.88|
000020  a901              ADD      r1,sp,#4
000022  4620              MOV      r0,r4
000024  f7fffffe          BL       TIM_TimeBaseInit
;;;551        TIM_ITConfig(TIM5,TIM_IT_Update,ENABLE); //Ã›ÕŠÑ­Ö¨Ê±Ç· 3 Ù¼Ñ‚××
000028  2201              MOVS     r2,#1
00002a  4611              MOV      r1,r2
00002c  4620              MOV      r0,r4
00002e  f7fffffe          BL       TIM_ITConfig
;;;552        NVIC_InitStructure.NVIC_IRQChannel=TIM5_IRQn; //Ö¨Ê±Ç· 3 ××
000032  2132              MOVS     r1,#0x32
000034  f88d1000          STRB     r1,[sp,#0]
;;;553        NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority=0x01; //È€Õ¼Ô…ÐˆÜ¶ 1
000038  2101              MOVS     r1,#1
00003a  f88d1001          STRB     r1,[sp,#1]
;;;554        NVIC_InitStructure.NVIC_IRQChannelSubPriority=0x02; //Ð¬Ó¦Ô…ÐˆÜ¶ 3
00003e  2202              MOVS     r2,#2
000040  f88d2002          STRB     r2,[sp,#2]
;;;555        NVIC_InitStructure.NVIC_IRQChannelCmd=ENABLE;
000044  f88d1003          STRB     r1,[sp,#3]
;;;556        NVIC_Init(&NVIC_InitStructure);// ÃœÔµÊ¼Û¯ NVIC
000048  4668              MOV      r0,sp
00004a  f7fffffe          BL       NVIC_Init
;;;557        TIM_Cmd(TIM5,ENABLE); //ÃÊ¹ÅœÖ¨Ê±Ç· 3
00004e  2101              MOVS     r1,#1
000050  4620              MOV      r0,r4
000052  f7fffffe          BL       TIM_Cmd
;;;558    }
000056  bd7f              POP      {r0-r6,pc}
;;;559    
                          ENDP

                  |L7.88|
                          DCD      0x40000c00

                          AREA ||i.TIM6_Config||, CODE, READONLY, ALIGN=2

                  TIM6_Config PROC
;;;326    
;;;327    void TIM6_Config(void)
000000  b53e              PUSH     {r1-r5,lr}
;;;328    {
;;;329    	TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;
;;;330    	/* TIM3 ??? ---------------------------------------------------
;;;331       TIM3 ????(TIM3CLK) ??? APB2 ?? (PCLK2)    
;;;332        => TIM3CLK = PCLK2 = SystemCoreClock
;;;333       TIM3CLK = SystemCoreClock, Prescaler = 0, TIM3 counter clock = SystemCoreClock
;;;334       SystemCoreClock ?48 MHz */
;;;335      /* TIM16 ???? */
;;;336      RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM6,ENABLE);
000002  2101              MOVS     r1,#1
000004  2010              MOVS     r0,#0x10
000006  f7fffffe          BL       RCC_APB1PeriphClockCmd
;;;337    	
;;;338      /* Time ??????*/
;;;339      TIM_TimeBaseStructure.TIM_Prescaler = 4800-1;//?????
00000a  f24120bf          MOV      r0,#0x12bf
00000e  f8ad0000          STRH     r0,[sp,#0]
;;;340      TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;  /* Time ????????????*/
000012  2000              MOVS     r0,#0
000014  f8ad0002          STRH     r0,[sp,#2]
;;;341      TIM_TimeBaseStructure.TIM_Period = 5000;
000018  f2413188          MOV      r1,#0x1388
00001c  9101              STR      r1,[sp,#4]
;;;342      TIM_TimeBaseStructure.TIM_ClockDivision = TIM_CKD_DIV1;
00001e  f8ad0008          STRH     r0,[sp,#8]
;;;343    //  TIM_TimeBaseStructure.TIM_RepetitionCounter = 0;
;;;344    
;;;345      TIM_TimeBaseInit(TIM6,&TIM_TimeBaseStructure);
000022  4c0a              LDR      r4,|L8.76|
000024  4669              MOV      r1,sp
000026  4620              MOV      r0,r4
000028  f7fffffe          BL       TIM_TimeBaseInit
;;;346    	TIM_ITConfig(TIM6,TIM_IT_Update,ENABLE);//??????§ä??
00002c  2201              MOVS     r2,#1
00002e  4611              MOV      r1,r2
000030  4620              MOV      r0,r4
000032  f7fffffe          BL       TIM_ITConfig
;;;347    	TIM_SetAutoreload(TIM6, 0xFF);//??PWM??¨º
000036  21ff              MOVS     r1,#0xff
000038  4620              MOV      r0,r4
00003a  f7fffffe          BL       TIM_SetAutoreload
;;;348    	TIM6_NVIC_Config();
00003e  f7fffffe          BL       TIM6_NVIC_Config
;;;349      /* TIM3 ?????*/
;;;350      TIM_Cmd(TIM6, ENABLE);
000042  2101              MOVS     r1,#1
000044  4620              MOV      r0,r4
000046  f7fffffe          BL       TIM_Cmd
;;;351    }
00004a  bd3e              POP      {r1-r5,pc}
;;;352    /***********************************************************************/
                          ENDP

                  |L8.76|
                          DCD      0x40001000

                          AREA ||i.TIM6_NVIC_Config||, CODE, READONLY, ALIGN=1

                  TIM6_NVIC_Config PROC
;;;352    /***********************************************************************/
;;;353    static void TIM6_NVIC_Config(void)
000000  b508              PUSH     {r3,lr}
;;;354    {
;;;355    	NVIC_InitTypeDef NVIC_InitStructure; 
;;;356    	
;;;357    	/* Enable the USART1 Interrupt */
;;;358    	NVIC_InitStructure.NVIC_IRQChannel = TIM6_DAC_IRQn;	 
000002  2036              MOVS     r0,#0x36
000004  f88d0000          STRB     r0,[sp,#0]
;;;359    	NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0x01;
000008  2001              MOVS     r0,#1
00000a  f88d0001          STRB     r0,[sp,#1]
;;;360    	NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0x03;
00000e  2103              MOVS     r1,#3
000010  f88d1002          STRB     r1,[sp,#2]
;;;361    	NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
000014  f88d0003          STRB     r0,[sp,#3]
;;;362    	NVIC_Init(&NVIC_InitStructure);
000018  4668              MOV      r0,sp
00001a  f7fffffe          BL       NVIC_Init
;;;363    }
00001e  bd08              POP      {r3,pc}
;;;364    
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  usartocflag
000000  00                DCB      0x00
                  usartshortflag
000001  00                DCB      0x00
                  calert
000002  00                DCB      0x00
                  resetflag
000003  00                DCB      0x00
                  resetcount
000004  0000              DCB      0x00,0x00
                  uocount
000006  0000              DCB      0x00,0x00
                  powcount
000008  0000              DCB      0x00,0x00
                  powflag
00000a  0000              DCB      0x00,0x00
                  finishflag
00000c  00000000          DCB      0x00,0x00,0x00,0x00
                  Tick_10ms
                          DCD      0x00000000
                  crec1
                          DCD      0x00000000
                  crec2
                          DCD      0x00000000
                  ctime
                          DCD      0x00000000
                  dctime
                          DCD      0x00000000
                  testi
                          DCD      0x00000000
                  bc_raw
                          DCD      0x00000000
                  cbc_raw
                          DCD      0x00000000
                  c_sum
                          DCD      0x00000000
                  OldTick
                          DCD      0x00000000
                  shortv
                          DCD      0x00000000

                          AREA ||area_number.13||, DATA, ALIGN=1

                          EXPORTAS ||area_number.13||, ||.data||
                  battery_c
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.14||, DATA, ALIGN=0

                          EXPORTAS ||area_number.14||, ||.data||
                  resdone
000000  00                DCB      0x00

                          AREA ||area_number.15||, DATA, ALIGN=2

                          EXPORTAS ||area_number.15||, ||.data||
                  watch
                          DCD      0x00000000

;*** Start embedded assembler ***

#line 1 "..\\drive\\TIM6.c"
	AREA ||.rev16_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___6_TIM6_c_119e0187____REV16|
#line 114 "D:\\Keil\\ARM\\CMSIS\\Include\\core_cmInstr.h"
|__asm___6_TIM6_c_119e0187____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___6_TIM6_c_119e0187____REVSH|
#line 128
|__asm___6_TIM6_c_119e0187____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
